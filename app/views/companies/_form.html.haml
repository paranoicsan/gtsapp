= form_for @company do |f|
  -if @company.errors.any?
    #error_explanation
      %h2= "#{pluralize(@company.errors.count, "error")} prohibited this company from being saved:"
      %ul
        - @company.errors.full_messages.each do |msg|
          %li= msg

  .field
    = f.label :title, 'Название'
    = f.text_field :title
  .field
    = f.label :date_added, 'Дата добавления'
    = f.date_select :date_added
  .field
    Социальный
    = check_box_tag "company[rubricator][0]", 1, @company.social_rubricator? || @company.full_rubricator?
    Коммерческий
    = check_box_tag "company[rubricator][1]", 2, @company.commercial_rubricator? || @company.full_rubricator?
  .field
    = f.label :company_source_id, 'Источник информации'
    = f.select(:company_source_id, options_for_select(CompanySource.all.collect{ |s| [s.name, s.id] },
      @company.company_source_id), {}, {:onChange => "ShowHideAgentList(#{CompanySource.from_agent_id})"})
    %div{ :id => "agent_list",
          :class => @company.company_source_id == CompanySource.from_agent_id ? "agent_list_visible" : "agent_list_hidden" }
      = f.label :agent_id, "Агент"
      = f.select(:agent_id, options_for_select(User.agents.collect{ |u| [u.username, u.id] },
      @company.agent_id), {:prompt => "Выберите агента"})

  Рубрики
  = select_tag("select_rubrics", options_for_select(Rubric.all.collect{ |s| [s.name, s.id] }),
  {:prompt => "Выберите рубрику", :onChange => "ShowHideAddRubLink()", :id => "select_rubrics_id"})
  = link_to "Добавить", "#", {:id => "add_rub_link"}
  #rubrics
    -if @company.rubrics.count > 0
      %table{ :id => "rubrics_table"}
        %tr
          %th Наименование
        -@company.rubrics.each do |rubric|
          %tr
            %td= rubric.name

    -else
      Рубрик не назначено.
  .actions
    = f.submit 'Сохранить'
